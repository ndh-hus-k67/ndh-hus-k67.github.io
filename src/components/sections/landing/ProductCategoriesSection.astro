---
import Icon from "@components/ui/icons/Icon.astro";
import { Image } from "astro:assets";

interface Category {
  slug: string;
  name: string;
  description: string;
  icon: string;
  count: number;
  image?: any;
  imageAlt?: string;
  features?: string[];
  highlights?: { label: string; value: string }[];
}

interface Props {
  title?: string;
  subTitle?: string;
  categories: Category[];
  lang?: string;
}

const {
  title = "Khám phá danh mục sản phẩm",
  subTitle = "HAHUTECH cung cấp đa dạng các loại bu lông, ốc vít và phụ kiện chất lượng cao cho mọi nhu cầu công nghiệp và xây dựng.",
  categories,
  lang = "vn",
} = Astro.props;

const productLabel = lang === "en" ? "products" : "sản phẩm";
const viewAllLabel = lang === "en" ? "View all" : "Xem tất cả";
const viewAllProductsLabel = lang === "en" ? "View all products" : "Xem tất cả sản phẩm";
---

<section
  class="mx-auto max-w-[85rem] px-4 py-10 sm:px-6 lg:px-8 lg:py-14 2xl:max-w-full"
>
  <!-- Section header -->
  <div class="mx-auto mb-10 max-w-3xl text-center lg:mb-14">
    <h2
      class="text-balance text-3xl font-bold tracking-tight text-neutral-800 dark:text-neutral-200 md:text-4xl md:leading-tight"
    >
      {title}
    </h2>
    {
      subTitle && (
        <p class="mt-3 text-pretty text-lg text-neutral-600 dark:text-neutral-400">
          {subTitle}
        </p>
      )
    }
  </div>

  <!-- Categories list - simple and content-focused -->
  <div class="space-y-8">
    {
      categories.map((category, index) => (
        <a
          href={lang === "en" ? `/en/products/${category.slug}` : `/products/${category.slug}`}
          class="group flex flex-col overflow-hidden rounded-xl border border-neutral-200 bg-white shadow-md dark:border-neutral-700 dark:bg-neutral-800 md:flex-row"
        >
          {/* Image section */}
          {category.image && (
            <div class="relative h-64 w-full overflow-hidden md:h-auto md:w-2/5 lg:w-1/3">
              <Image
                src={category.image}
                alt={category.imageAlt || category.name}
                class="h-full w-full object-cover"
                widths={[400, 768]}
                sizes="(max-width: 768px) 100vw, 40vw"
              />
              <div class="absolute inset-0 bg-gradient-to-t from-black/50 via-transparent to-transparent md:bg-gradient-to-r md:from-black/30" />

              {/* Category number */}
              <div class="absolute left-4 top-4 flex h-10 w-10 items-center justify-center rounded-full bg-white/95 text-base font-bold text-orange-600 dark:bg-neutral-900/95 dark:text-orange-400">
                {index + 1}
              </div>
            </div>
          )}

          {/* Content section */}
          <div class="flex flex-1 flex-col p-6 md:p-8">
            {/* Header */}
            <div class="mb-4 flex items-start gap-4">
              {/* Icon */}
              <div class="flex h-14 w-14 shrink-0 items-center justify-center rounded-lg bg-orange-600 text-white dark:bg-orange-500">
                <svg
                  class="h-7 w-7"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  viewBox="0 0 24 24"
                >
                  <path d={category.icon} />
                </svg>
              </div>

              {/* Title and count */}
              <div class="flex-1">
                <h3 class="mb-1 text-2xl font-bold text-neutral-800 dark:text-neutral-100 md:text-3xl">
                  {category.name}
                </h3>
                <p class="text-sm font-medium text-orange-600 dark:text-orange-400">
                  {category.count} {productLabel}
                </p>
              </div>
            </div>

            {/* Description */}
            <p class="mb-4 text-base leading-relaxed text-neutral-600 dark:text-neutral-400">
              {category.description}
            </p>

            {/* Features list */}
            {category.features && category.features.length > 0 && (
              <div class="mb-4">
                <ul class="grid gap-2 sm:grid-cols-2">
                  {category.features.map((feature) => (
                    <li class="flex items-start gap-2 text-sm text-neutral-700 dark:text-neutral-300">
                      <svg class="mt-0.5 h-5 w-5 shrink-0 text-orange-600 dark:text-orange-400" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
                      </svg>
                      <span>{feature}</span>
                    </li>
                  ))}
                </ul>
              </div>
            )}

            {/* Highlights */}
            {category.highlights && category.highlights.length > 0 && (
              <div class="mb-4 flex flex-wrap gap-4">
                {category.highlights.map((highlight) => (
                  <div class="rounded-lg bg-neutral-100 px-3 py-2 dark:bg-neutral-700">
                    <div class="text-xs font-medium text-neutral-500 dark:text-neutral-400">
                      {highlight.label}
                    </div>
                    <div class="text-sm font-bold text-neutral-800 dark:text-neutral-100">
                      {highlight.value}
                    </div>
                  </div>
                ))}
              </div>
            )}

            {/* Link */}
            <div class="mt-auto flex items-center gap-2 text-base font-semibold text-orange-600 transition-colors duration-200 group-hover:text-orange-700 dark:text-orange-400 dark:group-hover:text-orange-300">
              <span>{viewAllLabel}</span>
              <svg
                class="h-5 w-5 transition-transform duration-200 group-hover:translate-x-1"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                viewBox="0 0 24 24"
              >
                <path d="M5 12h14M12 5l7 7-7 7" />
              </svg>
            </div>
          </div>
        </a>
      ))
    }
  </div>

  {/* CTA at bottom */}
  <div class="mt-12 flex justify-center">
    <a
      href={lang === "en" ? "/en/products" : "/products"}
      class="inline-flex items-center gap-2 rounded-lg bg-orange-600 px-8 py-3 text-base font-semibold text-white transition-colors duration-200 hover:bg-orange-700 dark:bg-orange-500 dark:hover:bg-orange-600"
    >
      <span>{viewAllProductsLabel}</span>
      <svg
        class="h-5 w-5"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        viewBox="0 0 24 24"
      >
        <path d="M5 12h14M12 5l7 7-7 7" />
      </svg>
    </a>
  </div>
</section>
