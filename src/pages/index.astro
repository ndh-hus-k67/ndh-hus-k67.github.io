---
// Import the necessary components
import MainLayout from "@/layouts/MainLayout.astro";
import HeroSection from "@components/sections/landing/HeroSection.astro";
import HeroSectionAlt from "@components/sections/landing/HeroSectionAlt.astro";
import ClientsSection from "@components/sections/landing/ClientsSection.astro";
import FeaturesGeneral from "@components/sections/features/FeaturesGeneral.astro";
import FeaturesNavs from "@components/sections/features/FeaturesNavs.astro";
import TestimonialsSection from "@components/sections/testimonials/TestimonialsSection.astro";
import PricingSection from "@components/sections/pricing/PricingSection.astro";
import FAQ from "@components/sections/misc/FAQ.astro";
import AnnouncementBanner from "@components/ui/banners/AnnouncementBanner.astro";
import ProductCategoriesSection from "@components/sections/landing/ProductCategoriesSection.astro";
import heroImage from "@images/hero-image.avif";
import faqs from "@data/faqs.json";
import features from "@data/features.json";
import pricing from "@data/pricing.json";
import construction from "@images/construction-image.avif";
import tools from "@images/automated-tools.avif";
import dashboard from "@images/dashboard-image.avif";
import bulongImage from "@images/bu-long-category.avif";
import ocvitImage from "@images/oc-vit-category.avif";
import tantugiuImage from "@images/tan-tu-giu-category.avif";
import tantrutugiuImage from "@images/tan-tru-tu-giu-category.avif";
import trurentugiuImage from "@images/tru-ren-tu-giu-category.avif";
import senxichImage from "@/images/products/sen-xich/xich-chot-rong.avif";
import phukiennhomImage from "@/images/products/phu-kien-nhom/con-truot-thuyen.avif";
import { partnersData } from "@/data_files/constants";
import { getCollection } from "astro:content";
import type { CollectionEntry } from "astro:content";

// Lấy tất cả sản phẩm để đếm số lượng theo danh mục (Vietnamese only)
const allProducts: CollectionEntry<"products">[] = await getCollection("products", ({ id }) => {
  const normalizedId = id.replace(/\\/g, "/");
  return normalizedId.includes("vn/") || id.includes("vn\\");
});

// Định nghĩa các danh mục sản phẩm
const productCategories = [
  {
    slug: "bu-long",
    name: "Bu Lông",
    image: bulongImage,
    imageAlt: "Bộ sưu tập bu lông chất lượng cao",
    count: allProducts.filter(p => {
      const categorySlug = typeof p.data.category === 'string' ? p.data.category : p.data.category?.slug;
      return categorySlug === "bu-long";
    }).length
  },
  {
    slug: "oc-vit",
    name: "Ốc Vít",
    image: ocvitImage,
    imageAlt: "Các loại ốc vít đa dạng",
    count: allProducts.filter(p => {
      const categorySlug = typeof p.data.category === 'string' ? p.data.category : p.data.category?.slug;
      return categorySlug === "oc-vit";
    }).length
  },
  {
    slug: "tan-tu-giu",
    name: "Tán Tự Giữ",
    image: tantugiuImage,
    imageAlt: "Tán tự giữ chất lượng cao",
    count: allProducts.filter(p => {
      const categorySlug = typeof p.data.category === 'string' ? p.data.category : p.data.category?.slug;
      return categorySlug === "tan-tu-giu";
    }).length
  },
  {
    slug: "tan-tru-tu-giu",
    name: "Tán Trụ Tự Giữ",
    image: tantrutugiuImage,
    imageAlt: "Tán Trụ Tự Giữ chất lượng",
    count: allProducts.filter(p => {
      const categorySlug = typeof p.data.category === 'string' ? p.data.category : p.data.category?.slug;
      return categorySlug === "tan-tru-tu-giu";
    }).length
  },
  {
    slug: "tru-ren-tu-giu",
    name: "Trụ Ren Tự Giữ",
    image: trurentugiuImage,
    imageAlt: "Trụ ren tự giữ",
    count: allProducts.filter(p => {
      const categorySlug = typeof p.data.category === 'string' ? p.data.category : p.data.category?.slug;
      return categorySlug === "tru-ren-tu-giu";
    }).length
  },
  {
    slug: "sen-xich",
    name: "Sên Xích",
    image: senxichImage,
    imageAlt: "Sên xích chất lượng cao",
    count: allProducts.filter(p => {
      const categorySlug = typeof p.data.category === 'string' ? p.data.category : p.data.category?.slug;
      return categorySlug === "sen-xich";
    }).length
  },
  {
    slug: "phu-kien-nhom",
    name: "Phụ Kiện Nhôm Định Hình",
    image: phukiennhomImage,
    imageAlt: "Phụ kiện nhôm định hình chất lượng cao",
    count: allProducts.filter(p => {
      const categorySlug = typeof p.data.category === 'string' ? p.data.category : p.data.category?.slug;
      return categorySlug === "phu-kien-nhom";
    }).length
  }
];
---

<MainLayout>


  <HeroSection
    title=`Bu lông ốc vít chất lượng cao HAHU<span class="text-yellow-500 dark:text-yellow-400">TECH</span>`
    subTitle="Giải pháp liên kết cho công nghiệp và xây dựng"
    primaryBtn="Về chúng tôi"
    primaryBtnURL="/about-us"
    secondaryBtn="Liên hệ"
    secondaryBtnURL="/contact"
    withReview={true}
    rating=`<span class="font-bold">4.8</span> / 5`
    starCount={4}
    reviews=`Hơn <span class="font-bold">500+</span> khách hàng tin dùng`
    src={heroImage}
    alt="Sản phẩm bu lông ốc vít HAHUTECH"
  />

  <!-- <ClientsSection
    title="Được tin tưởng bởi các doanh nghiệp hàng đầu"
    subTitle="Đối tác của các công ty xây dựng và sản xuất lớn tại Việt Nam"
    partners={partnersData}
  /> -->

  <ProductCategoriesSection
    title="Danh mục sản phẩm"
    subTitle="Đa dạng sản phẩm bu lông, ốc vít và phụ kiện chất lượng cao"
    categories={productCategories}
  />

  <FeaturesGeneral
    title="Tại sao chọn HAHUTECH?"
    subTitle="Chuyên cung cấp và sản xuất bu lông, ốc vít với tiêu chuẩn chất lượng quốc tế, công nghệ hiện đại và cam kết mang đến giải pháp tối ưu cho mọi dự án."
    features={features}
  />

  <FeaturesNavs
    title=`<span class="text-yellow-500 dark:text-yellow-400">HAHUTECH</span> - Giải pháp hoàn hảo cho dự án của bạn`
    tabs={[
      {
        heading: "Chất lượng đảm bảo",
        content:
          "Sản xuất theo tiêu chuẩn quốc tế với công nghệ hiện đại, quy trình kiểm soát chất lượng nghiêm ngặt đảm bảo độ bền và độ chính xác cao.",
        svg: "tools",
        src: tools,
        alt: "Sản xuất bu lông ốc vít chất lượng cao",
        first: true,
      },
      {
        heading: "Đa dạng sản phẩm",
        content:
          "Kho hàng phong phú với nhiều kích thước và cấp độ bền khác nhau, sẵn sàng đáp ứng nhanh chóng mọi yêu cầu từ dự án nhỏ đến công trình lớn.",
        svg: "dashboard",
        src: dashboard,
        alt: "Kho hàng đa dạng sản phẩm",
        second: true,
      },
      {
        heading: "Dịch vụ chuyên nghiệp",
        content:
          "Tư vấn kỹ thuật chuyên sâu và hỗ trợ tận tâm. Đội ngũ luôn sẵn sàng tư vấn lựa chọn sản phẩm phù hợp và cung cấp giải pháp tối ưu.",
        svg: "house",
        src: construction,
        alt: "Dịch vụ tư vấn chuyên nghiệp",
      },
    ]}
  />

  <!-- <TestimonialsSection
    title="Khách hàng nói gì về chúng tôi"
    subTitle="Sản phẩm chất lượng cao, giao hàng nhanh chóng và dịch vụ chuyên nghiệp"
    testimonials={[
      {
        content:
          "HAHUTECH cung cấp sản phẩm bu lông ốc vít chất lượng cao với giá hợp lý. Sản phẩm đạt tiêu chuẩn, giao hàng đúng hạn. Chúng tôi rất hài lòng!",
        author: "Nguyễn Văn An",
        role: "Giám đốc kỹ thuật | Công ty Xây dựng Việt Nam",
        avatarSrc: "",
      },
    ]}
    statistics={[
      {
        count: "500+",
        description:
          "khách hàng tin tưởng",
      },
      {
        count: "50+",
        description:
          "loại sản phẩm đa dạng",
      },
      {
        count: "99%",
        description:
          "đạt tiêu chuẩn chất lượng",
      },
      {
        count: "24h",
        description:
          "giao hàng nội thành",
      },
    ]}
  /> -->

  <!-- <PricingSection pricing={pricing} /> -->

  <FAQ title="Câu hỏi thường gặp" faqs={faqs} />


</MainLayout>
